{% extends "admin/base_site.html" %}
{% load static %}

{% block title %}Informe de Ventas{% endblock %}

{% block content %}
  <div class="sales-report-container">
    <h1>Generar Informe de Ventas</h1>
    <form method="get" class="row g-3 align-items-center" action="">
      <div class="col-md-5">
        {{ form.as_p }}
      </div>
      <div class="col-md-2">
        <button type="submit" name="generate_pdf" class="btn btn-primary w-100">
          <i class="fas fa-file-pdf"></i> Generar Informe en PDF
        </button>
      </div>
      <div class="col-md-2">
        <button type="submit" name="generate_csv" class="btn btn-secondary w-100" style="background-color: #3730A3; border: none;">
          <i class="fas fa-file-csv"></i> Generar Informe en CSV
        </button>
      </div>
    </form>

    {% if report_data %}
      <hr>
      <h2>Resultados del Informe</h2>
      <p>Total de ventas: {{ total_sales }}</p>
      <p>Total de Ã³rdenes: {{ total_orders }}</p>
      <p>Venta promedio por pedido: {{ avg_sales_per_order }}</p>

      <h3>Ventas por Producto</h3>
      <table class="table table-striped">
        <thead>
          <tr>
            <th>Producto</th>
            <th>Cantidad Vendida</th>
            <th>Total Vendido</th>
          </tr>
        </thead>
        <tbody>
          {% for item in product_sales %}
            <tr>
              <td>{{ item.product__name }}</td>
              <td>{{ item.total_quantity }}</td>
              <td>{{ item.total_sales }}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% endif %}
  </div>
{% endblock %}

